addEventListener("message",({data:e})=>{let t=m(e.pixels),r=m(e.surroundingPixels),s=g(t),o=g(r),n=e.pixels.length,a=n+e.surroundingPixels.length,b=p(s,o,n,a),i={};for(let l of e.pixels){let c=l.r.toFixed()+"_"+l.g.toFixed()+"_"+l.b.toFixed();i[c]??=0,i[c]++}let u=Object.keys(i).length,f=u?u/16777216*100:0,x=n?e.sobelPixelsIntensitiesSum/n:0;postMessage({standardDeviation:s,surroundingStandardDeviation:o,visualAttractiveness:b,colorsCount:u,colorfulness:f,graphicLoad:x})});function m(e){let t=new Array(256).fill(0);for(let r of e)t[.2126*r.r+.7152*r.g+.0722*r.b]++;return t}function g(e){let t=0,r=0;for(let n=0;n<e.length;n++)t+=n*e[n],r+=e[n];t/=r;let s=0;for(let n=0;n<e.length;n++)s+=Math.pow(n-t,2)*e[n];s/=r;let o=Math.sqrt(s);return Number.isNaN(o)?0:o}function p(e,t,r,s){return e&&t&&s?Math.abs(e-t)*((r??0)/s):0}
